<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    Coloque o nome da empresa: <input type="text" id="ipt_nomeEmpresa"><br>
    Coloque a razão social: <input type="text" id="ipt_razaoSocial"><br>
    Coloque o CNPJ: <input type="text" id="ipt_cnpj"><br>
    Coloque o telefone <input type="text" id="ipt_telefone">

    <button onclick="cadastrar()">CADASTRAR</button><br><br>

    Coloque o seu nome: <input type="text" id="ipt_nomeUsuario"><br>
    Coloque o seu sobrenome: <input type="text" id="ipt_sobrenomeUsuario"><br>
    Coloque a seu email : <input type="email" id="ipt_email"><br>
    Coloque a sua senha : <input type="password" id="ipt_senha">

    <button onclick="cadastrar2()">CADASTRAR</button>

</body>

</html>
<script>
    function cadastrar() {
        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo
        var nomeEmpresaVar = ipt_nomeEmpresa.value;
        var razaoSocialVar = ipt_razaoSocial.value;
        var cnpjVar = ipt_cnpj.value;
        var telefoneVar = ipt_telefone.value;

        if (
            nomeEmpresaVar == "" ||
            razaoSocialVar == "" ||
            cnpjVar == "" ||
            telefoneVar == ""
        ) {
            alert("Campos em branco")
        }

        // Enviando o valor da nova input
        fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                nomeEmpresaServer: nomeEmpresaVar,
                razaoSocialServer: razaoSocialVar,
                cnpjServer: cnpjVar,
                telefoneServer: telefoneVar
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {
                    console.log(resposta);

                    resposta.json().then(json => {
                        console.log(json);
                        console.log(JSON.stringify(json));
                    });

                } else {
                    throw "Houve um erro ao tentar realizar o cadastro!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

        return false;
    }

    function cadastrar2() {
        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo
        var nomeUsuarioVar = ipt_nomeUsuario.value;
        var sobrenomeUsuarioVar = ipt_sobrenomeUsuario.value;
        var emailVar = ipt_email.value
        var senhaVar = ipt_senha.value;
        var fkEmpresaVar = 1;

        if (
            nomeUsuarioVar == "" ||
            sobrenomeUsuarioVar == "" ||
            senhaVar == ""
        ) {
            alert("Campos em branco")
        }

        // Enviando o valor da nova input
        fetch("/usuarios/cadastrar2", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                nomeUsuarioServer: nomeUsuarioVar,
                sobrenomeUsuarioServer: sobrenomeUsuarioVar,
                emailServer: emailVar,
                senhaServer: senhaVar,
                fkEmpresaServer: fkEmpresaVar
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {
                    console.log(resposta);

                    resposta.json().then(json => {
                        console.log(json);
                        console.log(JSON.stringify(json));
                    });

                } else {
                    throw "Houve um erro ao tentar realizar o cadastro!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

        return false;
    }

    //   function listar() {
    //     fetch("/empresas/listar", {
    //       method: "GET",
    //     })
    //       .then(function (resposta) {
    //         resposta.json().then((empresas) => {
    //           empresas.forEach((empresa) => {
    //             listaEmpresas.innerHTML += `<option value='${empresa.id}'>${empresa.cnpj}</option>`;
    //           });
    //         });
    //       })
    //       .catch(function (resposta) {
    //         console.log(`#ERRO: ${resposta}`);
    //       });
    //   }

</script>